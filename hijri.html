<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kalender Hijriah 2026</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
:root{
  --bg:#f5f5f5; --text:#000; --box:#fff; --border:#ccc; --header:#00897b;
  --event-bg:#fff3cd; --event-text:#7a5900;
}
body.dark{
  --bg:#121212; --text:#eee; --box:#1e1e1e; --border:#555; --header:#00695c;
  --event-bg:#3b2f00; --event-text:#ffdb6e;
}

body{ background:var(--bg); font-family:Arial; color:var(--text); padding:15px; }

/* === PROGRESS LOADER === */
#loaderBox{
  background: var(--box);
  border:1px solid var(--border);
  border-radius:10px;
  padding:15px;
  margin-bottom:10px;
}
#loadingProgress{
  height:12px;
  width:0%;
  background:green;
  border-radius:6px;
  transition:0.25s;
}
#progress{
  margin-top:6px;
  font-size:14px;
  text-align:center;
  color:var(--text);
}

/* Tombol atas */
.top-btn-group {
  display: flex;
  gap: 10px;
  margin-bottom: 2px;
  justify-content: center;
}
.top-btn-group button {
  padding: 8px 14px;
  background: var(--header);
  border: none;
  color: white;
  border-radius: 6px;
  font-size: 12px;
  cursor: pointer;
}

#searchInput{
  width:60%; padding:10px; border-radius:8px; font-size:12px; 
  border:1px solid var(--border); margin:12px 0; 
}
.search-container{
  display:flex;
  justify-content:center;
}

.month-box{
  background:var(--box); border:1px solid var(--border); border-radius:12px;
  margin-bottom:18px; overflow:auto;
}
  .highlight {
  background: yellow;
  color: black;
  font-weight: bold;
  padding: 0 2px;
  border-radius: 3px;
}
  .month-header {
  background: var(--header);
  color: white;
  padding: 12px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-radius: 3px;
}
.month-content{
  display: none;
  max-height: 480px;
  overflow-x:auto;
  overflow-y:auto;
  border-top:1px solid var(--border);
}
table{ width:100%; border-collapse:separate; border-spacing:0; }
thead th{
  position:sticky; top:0; background:#004d40; color:white; z-index:50; padding:10px;
}
th{ background:#004d40; color:white; padding:8px; font-size:12px; }
td{ border:1px solid #ddd; padding:8px; text-align:center; font-size:12px; color:green; font-weight:700; }
tr:nth-child(even){ background:#eaf7f6; }

.event-cell{
  background: lightgreen;
  color:black;
  font-weight:bold;
  border-radius:3px;
  padding:6px;
}

.today{ background:#2e7d32 !important; color:white !important; }

.hijri-month{
  margin-left: 8px; 
  font-size: 10px;
  padding: 3px 8px;
  background: #004d40;
  color: lightgreen;
  border-radius: 6px;
}
.masehi-small{
  font-size: 11px;
  color: gold;
  font-weight: bold;
}

.grid-card{
  background: var(--box);
  padding:12px;
  margin-bottom:10px;
  border-radius:10px;
  border-left:6px solid var(--header);
}
.grid-title{ font-size:18px; font-weight:bold; margin-bottom:10px; text-align:center; }
.back-btn-grid{ background:var(--header); color:white; padding:8px 14px; border-radius:8px; cursor:pointer; margin-bottom:12px; }

</style>
</head>

<body>

<h2 style="text-align:center; font-size: 14px; margin-top: 23px; color: brown;">ðŸ“… Kalender Hijriah 2026</h2>
  
<!-- â– â– â–  PROGRESS BOX â– â– â–  -->
<div id="loaderBox">
  <div id="loadingProgress"></div>
  <div id="progress">Menyiapkan...</div>
</div>
  
  <!-- ðŸ”¼ TOMBOL MODE GELAP & RELOAD (dipindah ke luar loader box) -->
<div class="top-btn-group">
  <button id="reloadBtn">ðŸ”„ Reload</button>
  <button id="themeBtn">ðŸŒ™ Mode Gelap</button>
</div>

<!-- ðŸ” SEARCH -->
<div class="search-container">
  <input type="text" id="searchInput" placeholder="Cari tanggal / bulan / event ...">
</div>

<div id="eventList"></div>
<div id="calendarContainer"></div>

<div id="gridView" style="display:none; background:var(--box); border:1px solid var(--border);
     padding:15px; border-radius:12px; margin-top:20px;"></div>
<span class="masehi-small"></span>
<script>
  
  history.scrollRestoration = "manual";   // â›” Matikan restore posisi scroll
history.pushState(null, null, location.href);
window.onpopstate = function () {
  if (!window.ignoreBack) {
    history.pushState(null, null, location.href);

    // Paksa kembali ke top
    window.scrollTo(0, 0);

    // Kunci scroll sementara
    document.body.style.overflow = "hidden";
    setTimeout(() => {
      document.body.style.overflow = "auto";
    }, 500);
  }
};
 
/* ============================================================
   BAGIAN 1 â€” PROGRESS LOADER + CONCURRENCY
   ============================================================ */
const progressEl = document.getElementById("progress");
const loadingBar = document.getElementById("loadingProgress");
const reloadBtn  = document.getElementById("reloadBtn");

const CONCURRENCY = 4;
const YEAR = 2026;

// 20 tugas dummy (nanti dipakai untuk proses awal agar loading terasa nyata)
let tasks = Array.from({length:20}, (_,i)=> async ()=>{
  progressEl.textContent = `Memuat data ${i+1} / ${tasks.length} ...`;
  loadingBar.style.width = ((i+1)/tasks.length*100)+"%";
  await new Promise(r=>setTimeout(r,120));
});

// MAIN LOADER
async function loadAll(){
  progressEl.textContent = "Memulaiâ€¦";
  loadingBar.style.width = "0%";

  const queue = tasks.slice();
  const workers = Array.from({length: CONCURRENCY}, async function worker(){
    while(queue.length){
      const t = queue.shift();
      if(!t) break;
      try{ await t(); }catch{}
    }
  });

  await Promise.all(workers);

progressEl.textContent = "Selesai memuat data...";
loadingBar.style.width = "100%";

// ðŸ”§ FIX: Reset agar tidak menumpuk saat muat ulang
months = {};
document.getElementById("calendarContainer").innerHTML = "";
document.getElementById("eventList").innerHTML = "";
document.getElementById("gridView").style.display = "none";

// Jalankan generator kalender
setTimeout(()=> generateCalendar(YEAR),400);
}
reloadBtn.onclick = loadAll;
loadAll();

/* ============================================================
   BAGIAN 2 â€” SELURUH SCRIPT KALENDER
   (100% sama seperti versi terakhir yang kamu kirim)
   ============================================================ */

/* ------------------- Fallback event, normalize, hijri, dan fungsi lainnya tetap sama ------------------- */
  const fallbackEvents=[
  { masehi:"01/01/2026",name:"Tahun Baru Masehi" },
  { masehi:"16/01/2026",name:"Isra' Mi'raj" },
  { masehi:"18/02/2026",name:"Awal Ramadhan" },
  { masehi:"05/03/2026",name:"Nuzulul Qurâ€™an" },
  { masehi:"19/03/2026",name:"Idul Fitri" },
  { masehi:"27/05/2026",name:"Idul Adha" },
  { masehi:"16/06/2026",name:"Tahun Baru Hijriyah" },
  { masehi:"24/08/2026",name:"Maulid Nabi" }
];

function normalize(d){
  let [day,month,year] = d.split("/");
  if(day.length === 1) day = "0" + day;
  if(month.length === 1) month = "0" + month;
  return `${day}/${month}/${year}`;
}

function getHijri(date){
  const parts = new Intl.DateTimeFormat("ar-TN-u-ca-islamic",{day:"numeric",month:"long",year:"numeric"}).formatToParts(date);
  let d,m,y;
  parts.forEach(p=>{ if(p.type==="day")d=p.value; if(p.type==="month")m=p.value; if(p.type==="year")y=p.value; });
  const tr={
    "Ù…Ø­Ø±Ù…":"Muharram","ØµÙØ±":"Safar","Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„":"Rabiul Awal","Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ø®Ø±":"Rabiul Akhir",
    "Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø£ÙˆÙ„Ù‰":"Jumadil Awal","Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø¢Ø®Ø±Ø©":"Jumadil Akhir","Ø±Ø¬Ø¨":"Rajab","Ø´Ø¹Ø¨Ø§Ù†":"Sya'ban",
    "Ø±Ù…Ø¶Ø§Ù†":"Ramadhan","Ø´ÙˆØ§Ù„":"Syawal","Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©":"Dzulqa'dah","Ø°Ùˆ Ø§Ù„Ø­Ø¬Ø©":"Dzulhijjah"
  };
  return `${d} ${tr[m]} ${y} H`;
}

let months={};
  
  
  function formatMasehi(d){
  const [day, month, year] = d.split("/");
  const namaBulan = ["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];
  return `${day} ${namaBulan[Number(month)-1]} ${year}`;
}
  
  /**function fixHijriJump(prevHijri, currentHijri) {
  if (!prevHijri) return currentHijri;

  const p = prevHijri.split(" ");
  const c = currentHijri.split(" ");

  let prevDay   = Number(p[0]);
  let currDay   = Number(c[0]);
  let prevMonth = p[1];
  let currMonth = c[1];
  let year      = c[2];

  // NORMAL: jika bulan sama â†’ selisih maksimal 1 hari
  if (prevMonth === currMonth) {
    if (currDay - prevDay > 1) {
      currDay = prevDay + 1;  // perbaiki loncatan
    }
    return `${currDay} ${currMonth} ${year}`;
  }**/

  // BULAN BARU
  // Jika berganti bulan, hari HARUS 1 atau 2 (karena variasi hisab)
  // Tetapi JANGAN DISET KE 1 jika API memberi "2" (valid)
  /**if (currDay > 2) currDay = 1;
    
return `${currDay} ${currMonth} ${year}`;
}**/
  
async function generateCalendar(year){ 
  let events;
  try{
    const r=await fetch("https://api-kemenag.caliph.my.id/api/v1/holiday");
    const j=await r.json();
    events=j.data.map(e=>({masehi:e.masehi,name:e.event}));
  }catch{
    events=fallbackEvents;
  }

  events = events.map(e => ({
    masehi: normalize(e.masehi),
    name: e.name
  }));

  const start=new Date(year,0,1), end=new Date(year,11,31);
  let date=start;

  while(date<=end){
    const masehiNorm = normalize(date.toLocaleDateString("id-ID"));
    const masehi = formatMasehi(masehiNorm);
    const hari = date.toLocaleDateString("id-ID",{weekday:"short"});
    const bulan= date.toLocaleDateString("id-ID",{month:"long"});
    const hijri=getHijri(date);
    
    let ev="";
  
    events.forEach(e=>{ if(e.masehi === masehiNorm) ev = e.name });

    if(!months[bulan]) months[bulan]=[];
    months[bulan].push({hari,masehi,hijri,event:ev});

    date.setDate(date.getDate()+1);
  }

  renderCards();
}

function showGrid(d){
  const box=document.getElementById("gridView");
  box.innerHTML = `
    <button class="back-btn-grid" onclick="closeGrid()">â¬… Kembali</button>
    <div class="grid-title">ðŸ“… Detail Hari</div>

    <div class="grid-card"><b>Hari:</b> ${d.hari}</div>
    <div class="grid-card"><b>Tanggal Masehi:</b> ${d.masehi}</div>
    <div class="grid-card"><b>Tanggal Hijriah:</b> ${d.hijri}</div>
    <div class="grid-card"><b>Hari Besar Islam:</b> ${d.event || "-"}</div>
  `;
  box.style.display="block";
  box.scrollIntoView({ behavior:"smooth" });
}

function closeGrid(){
  document.getElementById("gridView").style.display="none";
}

function renderCards(){
  const cont=document.getElementById("calendarContainer");
  cont.innerHTML="";

  Object.keys(months).forEach(name=>{
    const first = months[name][0].hijri.split(" ");
const last  = months[name][months[name].length - 1].hijri.split(" ");

const hijriStartMonth = first[1];
const hijriEndMonth   = last[1];
const hijriYear       = first[2];

// Tampilkan contoh: Rajab / Sya'ban 1447 H
let hijriLabel = hijriStartMonth;
if (hijriEndMonth !== hijriStartMonth) {
  hijriLabel += " / " + hijriEndMonth;
}

const headerTitle = `
  <span class="masehi-small">${name} 2026</span>
  <span class="hijri-month">${hijriLabel} ${hijriYear}</span>
`;
    
    let html = `
      <div class='month-box'>
        <div class='month-header' onclick='toggleMonth(this)'>
          ${headerTitle}
        </div>
        <div class='month-content'>
         <table>
  <thead>
    <tr>
      <th>Hari</th>
      <th>Tanggal Masehi</th>
      <th>Tanggal Hijriah</th>
      <th>Hari Besar Islam</th>
    </tr>
  </thead>
  <tbody>  
    `;

    months[name].forEach(d=>{
      const encoded = encodeURIComponent(JSON.stringify(d));
      html += `
        <tr data-item="${encoded}"
            onclick="showGrid(JSON.parse(decodeURIComponent(this.dataset.item)))"
            class="${d.masehi===new Date().toLocaleDateString('id-ID') ? 'today' : ''}">
          <td>${d.hari}</td>
          <td>${d.masehi}</td>
          <td>${d.hijri}</td>
          <td class="${d.event?'event-cell':''}">${d.event||''}</td>
        </tr>`;
    });

    html += `</table></div></div>`;
    cont.innerHTML+=html;
  });
}

function toggleMonth(h){
  const c=h.nextElementSibling;
  c.style.display=c.style.display==="block"?"none":"block";
}
  
  document.getElementById("searchInput").addEventListener("input", e => {
  const val = e.target.value.toLowerCase();

  // Tampilkan semua header bulan
  document.querySelectorAll(".month-header").forEach(h => {
    h.style.display = "";
  });

  // Selalu buka semua bulan saat pencarian
  document.querySelectorAll(".month-content").forEach(c => {
    c.style.display = "block";
  });

  // Hilangkan highlight lama
  document.querySelectorAll("td, .month-header").forEach(cell => {
    cell.innerHTML = cell.innerHTML.replace(/<span class="highlight">|<\/span>/g, "");
  });

  // Jika input kosong â†’ reset dan keluar
  if (val.trim() === "") {
    document.querySelectorAll("tr").forEach(r => r.style.display = "");
    return;
  }

  // Filter baris TR
  document.querySelectorAll("tr").forEach(r => {
    if (r.querySelector("th")) return; // Jangan sembunyikan header tabel

    const rowText = r.textContent.toLowerCase();
    if (rowText.includes(val)) {
      r.style.display = "";

      // Highlight dalam baris yang cocok
      r.querySelectorAll("td").forEach(cell => {
        const text = cell.textContent;
        const idx = text.toLowerCase().indexOf(val);

        if (idx >= 0) {
          const matched = text.substr(idx, val.length);
          cell.innerHTML = text.replace(
            new RegExp(matched, "i"),
            `<span class='highlight'>${matched}</span>`
          );
        }
      });

    } else {
      r.style.display = "none";
    }
  });
});

const themeBtn=document.getElementById("themeBtn");
function setTheme(d){
  document.body.classList.toggle("dark",d);
  themeBtn.textContent=d?"â˜€ Mode Terang":"ðŸŒ™ Mode Gelap";
  localStorage.setItem("theme",d?"dark":"light");
}
themeBtn.onclick=()=> setTheme(!document.body.classList.contains("dark"));
setTheme(localStorage.getItem("theme")==="dark");

// Tombol Mode Gelap
document.getElementById("themeBtn").onclick = () => {
  document.body.classList.toggle("dark");
};
  </script>
  </body>
</html>
  
   <!-- ðŸŒ¿ Hidden Double-Point Unlock System + Fade Animation -->
<style>
  body {
    margin: 0;
    font-family: "Poppins", sans-serif;
    background: #f9fff9;
  }

  /* Area titik rahasia (tak terlihat) */
  .secret-spot {
    position: fixed;
    width: 60px;
    height: 60px;
    z-index: 9999;
  }

  #spot-left {
    bottom: 10px;
    left: 10px;
  }

  #spot-right {
    bottom: 10px;
    right: 10px;
  }

#shareSection {
  text-align: center;
  background: linear-gradient(180deg, #ffffff, #e8fff0);
  border-radius: 18px;
  width: 90%;
  max-width: 420px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
  opacity: 0;
  transform: translateY(30px);
  pointer-events: none;
  transition: opacity 0.6s ease, transform 0.6s ease, max-height 0.6s ease, padding 0.6s ease, margin 0.6s ease;
  
  /* Tambahan penting */
  max-height: 0;
  overflow: hidden;
  padding: 0;         /* tidak memberi ruang */
  margin: 0 auto;     /* hilangkan gap full */
}

#shareSection.show {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
  margin: 15px auto;
  padding: 25px 0;    /* tampil kembali saat show */
  max-height: 500px;  /* cukup tinggi untuk konten */
}

  .share-container {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
  }

  .share-btn {
    text-decoration: none;
    color: /*#333*/brown;
    font-size: 8px;
    font-weight: 800;
    text-align: center;
  }

  .share-btn img {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: block;
    margin: 0 auto 5px auto;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
  }

  .share-btn:hover img {
    transform: scale(1.2);
    box-shadow: 0 0 8px rgba(0,0,0,0.3);
  }

  /* Notifikasi */
  .info-toast {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: #4caf50;
    color: white;
    padding: 10px 18px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 500;
    opacity: 0;
    transition: opacity 0.4s ease;
  }

  .info-toast.show {
    opacity: 1;
  }
</style>

<!-- ðŸ”’ Area klik rahasia -->
<div id="spot-left" class="secret-spot"></div>
<div id="spot-right" class="secret-spot"></div>

<!-- ðŸŒ Share Link Section -->
<div id="shareSection">
  <h4 style="margin-bottom:15px;font-size: 12px;color: grey;">Bagikan ke:</h4>
  <div class="share-container">
    <a class="share-btn" href="https://www.facebook.com/sharer/sharer.php?u=https://wisayadi.github.io/parameter-dashboard/" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/124/124010.png" alt="Facebook">Facebook
    </a>
    <a class="share-btn" href="https://twitter.com/intent/tweet?url=https://wisayadi.github.io/parameter-dashboard/" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/733/733579.png" alt="Twitter">Twitter
    </a>
    <a class="share-btn" href="https://wa.me/?text=Parameter%20Balikpapan%20https://wisayadi.github.io/parameter-dashboard/" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" alt="WhatsApp">WhatsApp
    </a>
    <a class="share-btn" href="https://t.me/share/url?url=https://wisayadi.github.io/parameter-dashboard/" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" alt="Telegram">Telegram
    </a>
  </div>
</div>

<!-- ðŸ”” Notifikasi -->
<div id="toast" class="info-toast">ðŸ”“ Share link dibuka</div>

<script>

  let shareVisible = false;

  const shareSection = document.getElementById("shareSection");
  const toast = document.getElementById("toast");

  // ðŸ”¥ Fungsi baru untuk tombol navigasi tengah
  function toggleShare() {
    shareVisible = !shareVisible;
    shareSection.classList.toggle("show", shareVisible);
    showToast(shareVisible ? "ðŸ”“ Share link dibuka" : "ðŸ”’ Share link ditutup");
  }

  function showToast(message) {
    toast.textContent = message;
    toast.classList.add("show");
    setTimeout(() => toast.classList.remove("show"), 2000);
  }
</script>
 
<style>
.card.muted {
  position: relative;
  text-align: center;
  font-size: 11px;
  color: purple;
  background: linear-gradient(90deg, #4caf50, #2196f3, #ff9800, #f44336);
  border-radius: 8px;
  margin-top: 18px;
  margin-bottom: 65px;
  width: 258px;
  padding: 8px 35px;
}

.muted-text {
  font-family: 'Poppins', sans-serif;
  font-weight: 500;
  letter-spacing: 0.5px;
}

.dot-gradient {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-weight: bold;
  font-size: 18px;
  background: linear-gradient(90deg, #fff, #ffd, #fff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: glow 2s infinite ease-in-out;
}
.left-dot { left: 12px; }
.right-dot { right: 12px; }

@keyframes glow {
  0%, 100% { opacity: 0.4; text-shadow: 0 0 6px rgba(255,255,255,0.3); }
  50% { opacity: 1; text-shadow: 0 0 10px rgba(255,255,255,0.6); }
}

    /* ====================== iOS NETWORK POPUP ======================= */
.net-popup-ios {
  position: fixed;
  top: -100px;
  left: 50%;
  transform: translateX(-50%) scale(0.95);
  padding: 14px 26px;
  font-size: 15px;
  font-weight: 600;
  border-radius: 22px;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  background: rgba(255, 255, 255, 0.23);
  color: #fff;
  box-shadow: 0px 6px 18px rgba(0,0,0,0.25);
  z-index: 999999;
  display: none;
  transition: all 0.6s cubic-bezier(.22,1.25,.32,1);
  letter-spacing: 0.4px;
  text-align: center;
}

.net-popup-ios.show {
  top: 20px;
  transform: translateX(-50%) scale(1);
}

.net-popup-ios.success {
  background: rgba(26, 188, 156, 0.55);
}

.net-popup-ios.error {
  background: rgba(231, 76, 60, 0.55);
}

/* Icon WiFi animasi */
.wifi-icon {
  display: inline-block;
  margin-right: 6px;
  animation: blink 1s infinite alternate ease-in-out;
}
@keyframes blink {
  0% { opacity: .3; transform: scale(0.9); }
  100% { opacity: 1; transform: scale(1); }
}

/* ===================== PING INDICATOR ===================== */
.ping-indicator {
  position: fixed;
  top: 10px;
  right: 10px;
  padding: 6px 10px;
  font-size: 12px;
  font-weight: 600;
  color: #fff;
  border-radius: 14px;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(10px);
  z-index: 999999;
}
 .bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  display: flex;
  justify-content: space-around;
  padding: 10px 0 14px;
  background: /*rgba(255, 255, 255, 0.55)*/rgba(0,0,0,0.4);
  backdrop-filter: blur(1px);
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
  box-shadow: 0 -6px 20px rgba(0, 0, 0, 0.15);
  z-index: 9999;
}

.nav-card {
  /*display: flex;
  flex-direction: column;
  align-items: center;
  width: 90px;
  padding: 6px 0;*/
  border-radius: 12px;
  border: none;
  /*background: rgba(255, 255, 255, 0.7);
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  cursor: pointer;
  transition: 0.25s ease;
  margin-bottom: 2px;*/
}

.nav-card .nav-icon {
  font-size: 20px;
  color: blue;
  margin-bottom: 3px;
}

.nav-card small {
  font-size: 9px;
  font-weight: 700;
  color: /*#333*/brown;
}

.nav-card:active {
  transform: scale(0.92);
  background: /*#e8f4ff*/ gold;
  box-shadow: 0 0 10px #77c4ff;
}   
</style>

<!-- =================== CARD SUMBER DATA =================== -->
<div class="card muted">
  <span class="dot-gradient left-dot">â€¢</span>
  <span class="muted-text">Sumber data: Kemenag</span>
  <span class="dot-gradient right-dot">â€¢</span>
</div>

<!-- Sound -->
<audio id="beepClick">
  <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
</audio>

<div class="bottom-nav">
  
  <button class="nav-card" onclick="goDashboard()">
    <span class="material-icons nav-icon">home</span>
    <small>Home</small>
  </button>

  <button class="nav-card" onclick="playBeep(); toggleShare()">
  <span class="material-icons nav-icon"style="color: red;">share</span>
  <small>Share</small>
</button>
  
 <button class="nav-card" onclick="reloadWithBeep()">   
  <span class="material-icons nav-icon"style="color: green;">restart_alt</span>
    <small>Reload</small>
  </button>  
</div>

<!-- =================== POPUP NETWORK =================== -->
<div id="netPopup" class="net-popup-ios"></div>
<!-- ============ PING INDICATOR ============ -->
<div id="pingBox" class="ping-indicator">ðŸ”„ Ping...</div>
    
<!-- Suara Notifikasi -->
<audio id="beepDisconnect" src="beep-off.mp3" preload="auto"></audio>
<audio id="beepConnect" src="beep-on.mp3" preload="auto"></audio>

<script>   
window.addEventListener("load", () => {

  const popup = document.getElementById("netPopup");
  const pingBox = document.getElementById("pingBox");

  const beepDC = document.getElementById("beepDisconnect");
  const beepCN = document.getElementById("beepConnect");

  function showPopup(msg, style) {
    popup.innerHTML = `<span class="wifi-icon">ðŸ“¶</span> ${msg}`;
    popup.className = `net-popup-ios ${style}`;
    popup.style.display = "block";

    setTimeout(() => popup.classList.add("show"), 20);

    setTimeout(() => {
      popup.classList.remove("show");
      setTimeout(() => popup.style.display = "none", 600);
    }, 10000);
  }

  window.addEventListener("offline", () => {
    showPopup("Jaringan Terputus", "error");
    beepDC.play().catch(()=>{});
    if (navigator.vibrate) navigator.vibrate([180,80,120]);
  });

  window.addEventListener("online", () => {
    showPopup("Internet Tersambung", "success");
    beepCN.play().catch(()=>{});
    if (navigator.vibrate) navigator.vibrate(120);
  });

  // ====================== PING CHECKER ======================
  async function pingTest() {
    const start = performance.now();
    try {
      await fetch("https://www.google.com", {mode: "no-cors"});
      const delay = Math.round(performance.now() - start);
      pingBox.innerText = `ðŸ“¶ ${delay} ms`;

      if(delay < 80) pingBox.style.background = "rgba(76,175,80,0.55)";
      else if(delay < 150) pingBox.style.background = "rgba(255,193,7,0.55)";
      else pingBox.style.background = "rgba(244,67,54,0.55)";

    } catch {
      pingBox.innerText = "âŒ Offline";
      pingBox.style.background = "rgba(244,67,54,0.55)";
    }
  }
  setInterval(pingTest, 2500);
  pingTest();

});
  /*function reloadWithBeep() {
  const beep = document.getElementById("beepClick");
  beep.currentTime = 0;     // restart suara dari awal
  beep.play();

  setTimeout(() => {
    location.reload();
  }, 250); // jeda sedikit agar beep terdengar dulu
}*/
  function goDashboard() {
  const beepClick = document.getElementById("beepClick");
  beepClick.play();
  window.ignoreBack = true;
  setTimeout(() => {
    window.location.href = "https://wisayadi.github.io/parameter-dashboard/cardipa.html";
  }, 200);
}
      
function reloadWithBeep() {
  const beep = document.getElementById("beepClick");
  if (beep) {
    beep.currentTime = 0;
    beep.play().catch(()=>{}); // cegah error berhenti script
  }

  setTimeout(() => {
    location.reload();
  }, 250);
}

function playBeep() {
  const beep = document.getElementById("beepClick");
  if (beep) {
    beep.currentTime = 0;
    beep.play().catch(()=>{}); // cegah error berhenti script
  }
  setTimeout(() => {
    location.share();
  }, 250);
}
</script>
